<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Luar Shop</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root { --primary: #764ba2; --bg: #f4f4f9; }
        body { font-family: -apple-system, BlinkMacSystemFont, sans-serif; margin: 0; background: var(--bg); }
        .tabs { display: flex; background: #fff; position: sticky; top: 0; z-index: 10; border-bottom: 1px solid #ddd; }
        .tab { flex: 1; padding: 15px; text-align: center; font-weight: bold; color: #888; cursor: pointer; }
        .tab.active { color: var(--primary); border-bottom: 3px solid var(--primary); }
        .content { padding: 15px; display: none; }
        .content.active { display: block; }
        .item-card { background: #fff; border-radius: 15px; padding: 15px; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .item-info h3 { margin: 0; font-size: 18px; }
        .item-info span { font-size: 13px; color: #2ecc71; font-weight: bold; }
        .price-tag { font-size: 18px; font-weight: bold; margin-right: 10px; }
        button { background: var(--primary); color: white; border: none; padding: 10px 18px; border-radius: 10px; font-weight: bold; cursor: pointer; }
        .profile-box { background: #fff; border-radius: 15px; padding: 20px; line-height: 1.6; }
    </style>
</head>
<body>
    <div class="tabs">
        <div class="tab active" onclick="switchTab('shop')">–ú–∞–≥–∞–∑–∏–Ω</div>
        <div class="tab" onclick="switchTab('profile')">–ü—Ä–æ—Ñ–∏–ª—å</div>
    </div>

    <div id="shop" class="content active">
        <div id="products"></div>
    </div>

    <div id="profile" class="content">
        <div class="profile-box">
            <h2 id="u-name">–ó–∞–≥—Ä—É–∑–∫–∞...</h2>
            <p>üÜî ID: <span id="u-id">0</span></p>
            <hr>
            <p>üíé L-coins: <b>0</b></p>
            <p>üí∞ –ë–∞–ª–∞–Ω—Å: <b>0.00 ‚ÇΩ</b></p>
        </div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        const config = { rate: 0.5, products: [10, 20, 50, 100, 500, 1000] };

        function switchTab(id) {
            document.querySelectorAll('.content').forEach(c => c.classList.remove('active'));
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            event.currentTarget.classList.add('active');
        }

        function render() {
            const container = document.getElementById('products');
            config.products.forEach(amt => {
                let discount = amt === 500 ? 0.10 : (amt === 1000 ? 0.15 : 0);
                let price = (amt * config.rate) * (1 - discount);
                
                container.innerHTML += `
                    <div class="item-card">
                        <div class="item-info">
                            <h3>${amt} L-coins</h3>
                            ${discount > 0 ? `<span>–°–∫–∏–¥–∫–∞ ${discount*100}%</span>` : ''}
                        </div>
                        <div style="display:flex; align-items:center;">
                            <span class="price-tag">${price.toFixed(2)} ‚ÇΩ</span>
                            <button onclick="buy(${amt}, ${price})">–ö—É–ø–∏—Ç—å</button>
                        </div>
                    </div>`;
            });

            document.getElementById('u-name').innerText = tg.initDataUnsafe.user?.first_name || "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å";
            document.getElementById('u-id').innerText = tg.initDataUnsafe.user?.id || "0";
        }

        function buy(amt, prc) {
            tg.showConfirm(`–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –∑–∞–∫–∞–∑: ${amt} L-coins –∑–∞ ${prc.toFixed(2)} ‚ÇΩ?`, (ok) => {
                if(ok) tg.sendData(JSON.stringify({ action: 'order_lcoins', amount: amt, price: prc }));
            });
        }

        render();
    </script>
</body>
</html>
